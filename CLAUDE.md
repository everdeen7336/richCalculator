# 토키보 여행 대시보드 — 제품 전략 & 로드맵

---

## 1. 문제 정의

### 우리가 해결하는 핵심 문제

> **"여행 계획은 14개 탭을 열고 3시간을 소모하는 고통이다"**

구체적으로:

| # | 문제 | 현재 대안 | 대안의 한계 |
|---|------|----------|------------|
| P1 | **탭 지옥** — 항공편, 숙소, 일정, 날씨, 환율을 각각 다른 사이트에서 확인 | TripIt, 구글 스프레드시트 | 예산추적 없음, 한국어 미지원, UI 노후 |
| P2 | **항공편 불안** — 지연/게이트 변경을 항공사 앱보다 늦게 알게 됨 | Flighty | iOS만, 한국 항공사 약함, 월 $5 |
| P3 | **경비 혼란** — 여행 중 얼마 썼는지 모름, 귀국 후 정산이 고통 | Splitwise, 엑셀 | 여행 맥락(카테고리) 없음, 환율 수동 |
| P4 | **오프라인 단절** — 해외에서 데이터 없으면 일정 확인 불가 | 스크린샷, 수기 메모 | 변경 반영 안 됨, 비효율적 |
| P5 | **일정 최적화 부재** — 비올 때 야외 일정, 혼잡한 시간에 관광지 방문 | 감으로 판단 | 실시간 데이터 부재 |

### 우리가 해결하지 않는 것 (스코프 아웃)
- 숙소/항공권 **예약** (Phase 3에서 제휴로)
- 소셜 미디어형 여행 **피드** (크리에이터 경쟁 불필요)
- 가이드북 수준의 **장소 리뷰** (구글맵/트립어드바이저 영역)

---

## 2. 타겟 페르소나

### 🎯 주 페르소나: "계획형 자유여행자" — 지은 (29세)

| 항목 | 내용 |
|------|------|
| **직업** | IT 회사 마케터, 연차 15일 |
| **여행 빈도** | 해외 2~3회/년, 국내 4~5회/년 |
| **여행 스타일** | 자유여행 80%, 패키지 20%. 2~4명 그룹 |
| **디지털 리터러시** | 높음. 노션/구글시트로 일정 관리 시도 |
| **현재 행동** | 항공편 → 스카이스캐너, 일정 → 구글시트, 날씨 → 각 앱, 경비 → 카톡으로 사진 공유 후 귀국 후 엑셀 정산 |
| **핵심 고통** | "계획 세우는 데 3시간, 정산하는 데 2시간. 여행 자체보다 관리가 스트레스" |
| **지불 의향** | 월 5,000원 이하 (카페 라떼 1잔 수준이면 OK) |
| **전환 트리거** | "항공편 지연을 항공사보다 먼저 알려줬을 때" 또는 "더치페이 정산이 1분 안에 끝났을 때" |

### 🔹 보조 페르소나 A: "출장 잦은 직장인" — 민수 (35세)
- 해외 출장 월 1~2회, 항공편 추적이 핵심
- Flighty 쓰고 싶지만 iOS 전용 + 영어만
- **킬러 기능**: 실시간 항공편 알림 (한국어, 웹)

### 🔹 보조 페르소나 B: "그룹 여행 총무" — 하영 (27세)
- 친구 4~6명 그룹 여행의 "총무" 역할
- 일정 공유 + 경비 정산이 최대 고충
- **킬러 기능**: 그룹 경비 정산, 일정 링크 공유

---

## 3. MVP 기능 점검 (Problem ↔ Feature 매핑)

| 문제 | 현재 기능 | 해결 수준 | 갭 |
|------|----------|----------|-----|
| P1 탭지옥 | 항공편+일정+예산+날씨+시간 올인원 | ✅ 해결 | 숙소/액티비티 예약 연결 미구현 |
| P2 항공편 불안 | FlightCard (API 조회 + 카운트다운) | ⚠️ 부분 | **실시간 push 알림 없음** — CTA만 존재, 실제 알림 미구현 |
| P3 경비 혼란 | BudgetWidget (카테고리별 지출 추적) | ⚠️ 부분 | **그룹 정산 미구현** — CTA만 존재. 환율 자동 변환 없음 |
| P4 오프라인 | PWA + Service Worker 캐시 | ✅ 해결 | 프로덕션 테스트 필요 |
| P5 일정 최적화 | ItineraryWidget (DAY별 타임라인) | ⚠️ 부분 | **AI 최적화 미구현** — CTA만 존재. 날씨/혼잡도 미반영 |

### 현재 작동하지 않는 기능
- `AirportStatusWidget` — 커스텀 훅(`useForecast`, `useParking`) 미구현, UI 셸만 존재
- 프리미엄 CTA 4개 — 모두 버튼만 있고 실제 기능/결제 없음
- `ContextCard`, `RecordingTimeline` — page.tsx에서 import 제거됨 (미사용)

---

## 4. 배포 가설 & 검증 계획

### 가설 1: "올인원 대시보드가 탭 전환을 줄여 체류 시간을 높인다"

| 항목 | 내용 |
|------|------|
| **측정 지표** | 세션 당 평균 체류 시간 |
| **성공 기준** | 3분 이상 (일반 도구 사이트 평균 1.5분) |
| **검증 방법** | Google Analytics 세션 시간 + 이벤트(항공편 등록, 장소 추가, 지출 기록) |
| **실패 시 피벗** | 올인원이 과한 경우 → 항공편 추적 단일 기능으로 축소 |

### 가설 2: "항공편 등록이 핵심 전환 퍼널이다"

| 항목 | 내용 |
|------|------|
| **측정 지표** | 방문자 → 항공편 등록 전환율 |
| **성공 기준** | 30% 이상 (첫 방문자 10명 중 3명이 항공편 등록) |
| **검증 방법** | 항공편 등록 이벤트 추적 (API 호출 + 수동 등록) |
| **실패 시 피벗** | 항공편 없이도 일정 만들 수 있는 "장소 우선" 모드 추가 |

### 가설 3: "프리미엄 CTA가 구독 의향을 만든다"

| 항목 | 내용 |
|------|------|
| **측정 지표** | CTA 클릭률 (CTR) |
| **성공 기준** | 5% 이상 (항공편 등록자 중 CTA 클릭) |
| **검증 방법** | 각 CTA 버튼에 이벤트 추적, 가장 높은 CTR → Phase 2 첫 구현 대상 |
| **실패 시 피벗** | CTA 위치/문구 A/B 테스트, 또는 무료 기능 더 줄여서 페이월 강화 |

### 가설 4: "공유를 통한 바이럴 성장이 가능하다"

| 항목 | 내용 |
|------|------|
| **측정 지표** | 공유 버튼 클릭 → 신규 방문자 유입 (K-factor) |
| **성공 기준** | K-factor > 0.3 (사용자 10명이 3명의 신규 유입 생성) |
| **검증 방법** | 공유 링크에 UTM 파라미터, 레퍼럴 트래킹 |
| **실패 시 피벗** | 공유보다 SEO/콘텐츠 마케팅(여행 체크리스트 블로그)으로 전환 |

### MVP 배포 후 1주일 핵심 대시보드

```
📊 DAU: ___    📋 항공편 등록: ___%    💰 CTA 클릭: ___%
🔗 공유: ___건  ⏱️ 평균 체류: ___분    🔄 재방문율: ___%
```

**Go/No-Go 기준 (2주 후 판단)**:
- ✅ Go → Phase 2: DAU 50+ AND 항공편 등록률 30%+ AND CTA CTR 5%+
- ⚠️ Iterate: 지표 중 1개만 미달 → A/B 테스트로 개선
- ❌ Pivot: 전체 미달 → 항공편 추적 단일 앱으로 피벗

---

## 5. 시장 분석 요약

### 경쟁 환경
| 카테고리 | 주요 플레이어 | 수익 모델 | 약점 |
|---------|-------------|----------|------|
| 항공편 추적 | Flighty ($60/년, 월매출 $400K) | 구독 | iOS만, 일정관리 없음 |
| 일정 관리 | TripIt ($49/년), Wanderlog | 프리미엄 구독 | 예산추적 없음, UI 노후화 |
| 예약 플랫폼 | 마이리얼트립 (매출 892억), 트리플 | 중개 수수료 15-30% | 계획 도구 약함 |
| AI 일정 | Dream Trip, Jotform AI | 구독 + 제휴 | 실시간 데이터 없음 |

### 돈 되는 페인포인트 (사용자가 비용을 지불하는 문제)

1. **실시간 항공편 알림** — Flighty가 월 $400K 매출 증명. 항공사보다 빠른 지연/게이트 변경 알림
2. **올인원 여행 대시보드** — 14개 탭 열어놓는 "탭 지옥" 해결. 항공+숙소+일정+경비를 한 곳에
3. **경비 추적 + 정산** — 그룹 여행 시 더치페이/정산이 최대 고충. Splitwise가 해결 못하는 여행 맥락
4. **오프라인 일정 접근** — 해외에서 데이터 없을 때 일정 확인 불가. 오프라인 모드 프리미엄 기능
5. **AI 일정 최적화** — 날씨/혼잡도 기반 실시간 일정 재조정. AI Tourism 시장 CAGR 29%

### 수익화 모델 우선순위

1. **프리미엄 구독 (월 4,900원 / 년 39,900원)** — 가장 빠른 수익화. Flighty/TripIt 검증 완료
2. **제휴 커미션** — 숙소/액티비티/보험 예약 연결 시 수수료 (5-15%)
3. **크리에이터 마케팅** — 마이리얼트립 방식. 여행 크리에이터의 일정 공유 → 예약 전환

---

## 6. 여행 여정 세분화 & 넛징 시스템

### 페르소나 "지은"의 실제 여행 준비 과정

여행을 결정한 순간부터 귀국까지, 사용자는 아래 **8단계**를 거친다.
토키보는 각 단계에서 "다음에 뭘 해야 하는지"를 자연스럽게 넛징한다.

```
[결심] → [항공권] → [숙소] → [일정] → [준비물] → [출국] → [현지] → [귀국]
  S1       S2        S3       S4        S5         S6       S7       S8
```

### 단계별 정의

#### S1. 여행 결심 (Dreaming)
| 항목 | 내용 |
|------|------|
| **사용자 행동** | 목적지 탐색, 일정 잡기, 동행자 확정 |
| **현재 기능** | 3D 지구본 히어로, "어디로 떠나시나요?" |
| **넛징** | 지구본 클릭 시 인기 목적지 표시, 여행 시작일 입력 유도 |
| **완료 조건** | `destination` + `departureDate` 설정됨 |

#### S2. 항공권 확보 (Flight Booking)
| 항목 | 내용 |
|------|------|
| **사용자 행동** | 스카이스캐너/네이버에서 항공권 검색 → 구매 → 편명 받음 |
| **현재 기능** | FlightCard (편명+날짜 입력 → API 조회) |
| **넛징** | S1 완료 시: "항공권을 찾으셨나요? 편명을 등록하면 실시간 추적이 시작돼요" |
| **외부 연결** | 스카이스캐너/네이버항공 검색 링크 (목적지 자동 채움) |
| **완료 조건** | `departureFlight` !== null |

#### S3. 숙소 예약 (Accommodation)
| 항목 | 내용 |
|------|------|
| **사용자 행동** | 부킹닷컴/에어비앤비에서 숙소 검색 → 예약 → 확인번호 받음 |
| **현재 기능** | ❌ 없음 (예산 카테고리에 "숙소"만 있음) |
| **필요 기능** | `AccommodationCard` — 숙소명, 체크인/아웃 날짜, 주소, 확인번호, 메모 |
| **넛징** | S2 완료 시: "항공편 등록 완료! 다음은 숙소를 정해볼까요?" |
| **외부 연결** | 부킹닷컴/에어비앤비 검색 링크 (목적지+날짜 자동 채움) |
| **완료 조건** | `accommodation` 1개 이상 등록 |

#### S4. 일정 짜기 (Itinerary Planning)
| 항목 | 내용 |
|------|------|
| **사용자 행동** | 가고 싶은 장소 리서치 → DAY별 배치 → 동선 최적화 |
| **현재 기능** | ItineraryWidget (장소 추가, DAY별 그룹) |
| **넛징** | S3 완료 시: "숙소 근처 인기 장소를 추가해보세요" |
| **외부 연결** | 구글맵/망고플레이트/트립어드바이저 검색 링크 |
| **완료 조건** | `items.length` >= 여행일수 × 2 (하루 최소 2곳) |

#### S5. 준비물 챙기기 (Packing & Prep)
| 항목 | 내용 |
|------|------|
| **사용자 행동** | 여권 확인, 환전, 보험, 로밍/eSIM, 짐 싸기 |
| **현재 기능** | ScheduleWidget (preparation 체크리스트 6항목) |
| **넛징** | S4 완료 시: "일정이 완성되었어요! 출발 전 준비물을 확인하세요" |
| **세분화** | 서류(여권/비자), 금융(환전/카드), 통신(eSIM/로밍), 짐(의류/세면), 보험 |
| **완료 조건** | preparation 체크리스트 100% 완료 |

#### S6. 출국 당일 (Departure Day)
| 항목 | 내용 |
|------|------|
| **사용자 행동** | 공항 이동 → 체크인 → 보안검색 → 출국심사 → 탑승 |
| **현재 기능** | ScheduleWidget (departure 체크리스트, 시간 기반 자동생성) |
| **넛징** | 출발 24시간 전: phase 자동 전환 제안 "내일 출발이에요! 여행 모드로 전환할까요?" |
| **완료 조건** | departure 체크리스트 100% + 탑승 완료 |

#### S7. 현지 여행 (On-trip)
| 항목 | 내용 |
|------|------|
| **사용자 행동** | 일정 따라 이동, 경비 지출, 사진 촬영 |
| **현재 기능** | ItineraryWidget + BudgetWidget + WeatherWidget |
| **넛징** | 매일 아침: "오늘의 일정 3곳" 요약 표시, 날씨 기반 팁 ("우산 챙기세요 🌧") |
| **완료 조건** | returnFlight 탑승일 도래 |

#### S8. 귀국 (Return)
| 항목 | 내용 |
|------|------|
| **사용자 행동** | 귀국편 탑승 → 입국심사 → 수하물 → 정산 |
| **현재 기능** | ReturnFlightCard + ScheduleWidget (arrival 체크리스트) |
| **넛징** | 귀국 후: "여행 경비 총 ₩850,000 — 정산하기", "여행은 어떠셨나요? 기록 남기기" |
| **완료 조건** | arrival 체크리스트 100% |

---

### 넛징 엔진 설계

#### 핵심 원칙
1. **Pull, not Push** — 알림이 아닌, 방문할 때마다 "다음 할 일"이 눈에 들어오는 설계
2. **맥락 인식** — 현재 단계를 자동 감지하고 해당 단계의 넛징만 표시
3. **점진적 공개** — 모든 기능을 한꺼번에 보여주지 않음. 단계에 맞는 위젯만 강조
4. **성취감** — 단계 완료 시 시각적 보상 (체크 애니메이션, 진행률 업데이트)

#### 여정 진행률 (Journey Progress)

```typescript
// 자동 계산되는 여정 단계
type JourneyStage = 'dreaming' | 'flight' | 'accommodation' | 'itinerary' | 'packing' | 'departure' | 'ontrip' | 'return';

// 각 단계의 완료 조건
const stageCompletion = {
  dreaming:      () => !!destination && !!departureDate,
  flight:        () => !!departureFlight,
  accommodation: () => accommodations.length > 0,
  itinerary:     () => items.length >= tripDays * 2,
  packing:       () => preparationChecklist.every(i => i.done),
  departure:     () => departureChecklist.every(i => i.done),
  ontrip:        () => isAfterDeparture && isBeforeReturn,
  return:        () => arrivalChecklist.every(i => i.done),
};
```

#### NudgeBar 컴포넌트 (새로 구현)

대시보드 상단, GlobeHero 아래에 위치하는 컨텍스트 인식 넛지 바:

```
┌─────────────────────────────────────────────────────┐
│ ✈️ 항공편 등록 완료!                                  │
│ 👉 다음 단계: 숙소를 예약하고 등록해보세요             │
│                                                     │
│ [부킹닷컴에서 검색] [에어비앤비에서 검색] [직접 등록]  │
│                                                     │
│ ● ● ● ○ ○ ○ ○ ○  여행 준비 37%                     │
└─────────────────────────────────────────────────────┘
```

| 현재 단계 | 넛지 메시지 | CTA 버튼 |
|----------|-----------|---------|
| S1 미완료 | "여행 날짜를 정해보세요" | [날짜 선택] |
| S1 → S2 | "어디로 가는 항공편인가요?" | [편명 등록] |
| S2 → S3 | "항공편 등록 완료! 숙소를 정해볼까요?" | [부킹닷컴] [에어비앤비] [직접 등록] |
| S3 → S4 | "숙소 확정! 가고 싶은 장소를 추가해보세요" | [장소 추가] |
| S4 → S5 | "일정 완성! 출발 전 준비물을 확인하세요" | [체크리스트 보기] |
| S5 완료 | "준비 완료! 출발일까지 D-{n}" | [여행 모드로 전환] |
| S6 진입 | "오늘 출발이에요! 공항 수속 체크리스트" | [체크리스트 열기] |
| S7 진입 | "오늘의 일정: {place1}, {place2}..." | [일정 보기] |
| S8 진입 | "여행 수고하셨어요! 경비를 정리해볼까요?" | [정산하기] |

#### 외부 서비스 딥링크 (제휴 준비)

사용자가 직접 예약하되, 토키보가 편리하게 연결:

| 서비스 | 용도 | 딥링크 파라미터 |
|--------|------|---------------|
| 스카이스캐너 | 항공권 검색 | `?origin=ICN&destination={dest}&date={date}` |
| 네이버 항공권 | 항공권 검색 | `?dep={origin}&arr={dest}&date={date}` |
| 부킹닷컴 | 숙소 검색 | `?dest={dest}&checkin={date}&checkout={date}` |
| 에어비앤비 | 숙소 검색 | `?location={dest}&checkin={date}&checkout={date}` |
| 구글맵 | 장소 검색 | `?q={dest}+맛집` / `?q={dest}+관광지` |
| 트립어드바이저 | 장소 검색 | `?q={dest}` |

#### 필요한 새 데이터 모델

```typescript
// 숙소 정보
interface Accommodation {
  id: string;
  name: string;              // "시부야 도큐 호텔"
  type: 'hotel' | 'airbnb' | 'hostel' | 'guesthouse' | 'other';
  checkIn: string;           // ISO date "2025-03-15"
  checkOut: string;          // ISO date "2025-03-18"
  address?: string;
  confirmationCode?: string; // 예약 확인번호
  cost?: number;             // 1박 비용
  currency?: string;         // "JPY"
  memo?: string;
  booked: boolean;           // 예약 완료 여부
}

// 여정 진행 상태 (자동 계산, 저장 불필요)
interface JourneyProgress {
  currentStage: JourneyStage;
  completedStages: JourneyStage[];
  overallPercent: number;     // 0-100
  nextAction: {
    message: string;
    ctaLabel: string;
    ctaAction: string;        // 'scroll-to-flight' | 'open-accommodation' | 'add-place' | ...
  };
}

// 준비물 체크리스트 세분화
type PackingCategory = 'documents' | 'finance' | 'communication' | 'clothing' | 'toiletries' | 'electronics' | 'medical';

interface PackingItem {
  id: string;
  category: PackingCategory;
  label: string;
  done: boolean;
  essential: boolean;        // 필수 vs 선택
  notes?: string;            // "유효기간 6개월 이상"
}
```

#### 구현 우선순위

| 순서 | 기능 | 복잡도 | 사용자 임팩트 |
|------|------|--------|-------------|
| 1 | **NudgeBar** — 여정 단계 감지 + 다음 행동 넛징 | 중 | ★★★★★ |
| 2 | **AccommodationCard** — 숙소 등록/표시 위젯 | 중 | ★★★★ |
| 3 | **JourneyProgress** — 진행률 계산 + 프로그레스 바 | 소 | ★★★★ |
| 4 | **외부 딥링크** — 스카이스캐너/부킹닷컴 연결 | 소 | ★★★ |
| 5 | **PackingChecklist 세분화** — 카테고리별 준비물 | 중 | ★★★ |
| 6 | **D-day 카운트다운** — 출발까지 남은 일수 표시 | 소 | ★★★ |
| 7 | **phase 자동 전환 제안** — 출발 24h 전 알림 | 소 | ★★ |
| 8 | **일일 브리핑** — 오늘의 일정/날씨 요약 | 중 | ★★ |

---

### Phase 1: MVP (현재 → 4주)
**목표**: 무료 사용자 확보 + 핵심 가치 증명

- [x] 항공편 등록 (API + 수동)
- [x] 3D 지구본 + 항로 시각화
- [x] 현지 시간/날씨 위젯
- [x] 예산 관리 기본
- [x] **출국 체크리스트 정리** (3종 분리: 준비/수속/입국, phase별 표시)
- [x] **일정 관리 개선** (ItineraryWidget: 장소 추가 → DAY별 타임라인)
- [x] **PWA 오프라인 모드** (next-pwa + Service Worker, API/정적 자산 캐시)
- [x] **공유 기능** (Web Share API + 클립보드 폴백, OG 메타 태그)
- [x] **phase 2개로 단순화** (planning + traveling)
- [x] **프리미엄 CTA 삽입** (항공편/예산/체크리스트/일정 위젯에 업셀 훅)
- [x] **랜딩 히어로** (3D 지구본 + 가치 제안 문구)

### Phase 2: 구독 도입 (4주 → 8주)
**목표**: 프리미엄 구독 런칭, 월 100명 유료 전환

무료 기능:
- 항공편 1개 등록
- 기본 일정 관리
- 날씨/시간 위젯

프리미엄 기능 (월 4,900원):
- **실시간 항공편 알림** (지연, 게이트 변경, 수하물 벨트)
- **무제한 항공편** (출국+귀국+경유)
- **AI 일정 최적화** (날씨/혼잡도 기반 추천)
- **오프라인 모드**
- **경비 정산** (그룹 더치페이)
- **커스텀 체크리스트**

### Phase 3: 플랫폼 확장 (8주 → 16주)
**목표**: 제휴 수익 + MAU 10,000

- 숙소/액티비티 제휴 예약 (Booking.com/클룩 API)
- 여행 보험 연결
- 크리에이터 일정 템플릿 마켓
- 환율/면세 계산기
- 그룹 여행 공동 편집

### Phase 4: 데이터 + AI (16주+)
**목표**: 차별화된 AI 경험

- 개인화 여행 추천 엔진
- 실시간 혼잡도 예측
- 항공권 가격 예측 (Hopper 모델)
- 여행 기록 → 자동 포토북/블로그 생성

---

## MVP 사이트 정돈 방향

### 현재 문제
1. phase 4개(준비/조율/현지/기록)가 위젯 중복이 심함 → 차별점 불명확
2. 체크리스트가 단일 배열로 출국/입국 구분 없음
3. ScheduleWidget이 체크리스트와 일정을 혼동
4. 수익화 연결점이 전혀 없음 (프리미엄 기능 안내 없음)

### 정돈 완료 ✅
1. ✅ **phase 2개로 단순화**: `📋 계획(planning)` + `✈️ 여행 중(traveling)`
2. ✅ **체크리스트 3종 분리**: 🧳준비 / ✈️수속 / 🛬입국 (카테고리별 섹션)
3. ✅ **프리미엄 훅 삽입**: 항공편·예산·체크리스트·일정 위젯에 CTA
4. ✅ **랜딩 히어로**: 3D 지구본 + "어디로 떠나시나요?" 가치 제안
5. ✅ **일정 관리**: ItineraryWidget (DAY별 타임라인, 장소 추가)
6. ✅ **PWA**: Service Worker + manifest + 오프라인 캐시
7. ✅ **공유**: Web Share API + 클립보드 복사 + OG 메타

---

## 개발 진행 현황 (최종 업데이트: 2026-02-03)

### Phase 1 MVP 체크리스트 — 구현 완료 항목

| 기능 | 상태 | 비고 |
|------|------|------|
| 항공편 등록 (API + 수동) | ✅ 완료 | AviationStack/AirLabs/AeroDataBox 3중 폴백 |
| 귀국편 등록 | ✅ 완료 | ReturnFlightCard |
| 경유편 등록 | ✅ 완료 | TransitFlightCard (다중 경유 지원) |
| 야간 비행 (다음날 도착) 처리 | ✅ 완료 | 출발/귀국/경유 모두 적용, "+1" 표시 |
| 항공편 수정/삭제 | ✅ 완료 | 수정 시 취소 버튼, 출발편만 개별 초기화 |
| 3D 지구본 + 항로 시각화 | ✅ 완료 | GlobeHero (Three.js) |
| 현지 시간 위젯 | ✅ 완료 | ClockWidget |
| 날씨 위젯 | ✅ 완료 | WeatherWidget (OpenWeatherMap) |
| 예산 관리 | ✅ 완료 | BudgetWidget (카테고리별 계획/지출, 총예산 편집) |
| 체크리스트 3종 분리 | ✅ 완료 | ScheduleWidget (준비/수속/입국, phase별 표시) |
| 일정 관리 (DAY별 타임라인) | ✅ 완료 | ItineraryWidget (장소 추가, 드래그&드롭 재정렬, 크로스-DAY 이동) |
| 숙소 등록 | ✅ 완료 | AccommodationCard |
| NudgeBar (여정 넛징) | ✅ 완료 | 8단계 자동 감지, 진행률 바, D-day, CTA, 외부 딥링크 |
| PWA 오프라인 모드 | ✅ 완료 | Service Worker + 캐시 |
| 공유 기능 | ✅ 완료 | Web Share API + 클립보드 폴백 + OG 메타 |
| phase 2개 단순화 | ✅ 완료 | planning / traveling |
| 프리미엄 CTA 삽입 | ✅ 완료 | 4개 위젯에 업셀 훅 |
| 랜딩 히어로 | ✅ 완료 | 3D 지구본 + 가치 제안 |
| QuickLinkCard | ✅ 완료 | 출국/입국 안내 링크 |
| PhaseIndicator | ✅ 완료 | planning ↔ traveling 전환 |

### Phase 1 — 미완료 / 알려진 한계

| 항목 | 상태 | 설명 |
|------|------|------|
| AirportStatusWidget | ⚠️ UI 셸만 | useForecast, useParking 커스텀 훅 미구현 |
| 프리미엄 CTA 4개 | ⚠️ 버튼만 | 실제 기능/결제 없음 (검증용 CTR 측정 목적) |
| 실시간 push 알림 | ❌ 미구현 | Phase 2 범위 |
| 그룹 경비 정산 | ❌ 미구현 | Phase 2 범위 |
| AI 일정 최적화 | ❌ 미구현 | Phase 2 범위 |
| CanvasSearch / ContextCard / RecordingTimeline | 🗑️ 미사용 | page.tsx에서 제거됨, 파일만 잔존 |

### 넛징 시스템 구현 현황 (섹션 6 대비)

| 구현 우선순위 항목 | 상태 | 비고 |
|-------------------|------|------|
| 1. NudgeBar | ✅ 완료 | 8단계 감지 + 넛지 메시지 + CTA + 외부 딥링크 + 진행률 |
| 2. AccommodationCard | ✅ 완료 | 숙소 등록/표시/수정/삭제 |
| 3. JourneyProgress | ✅ 완료 | NudgeBar 내 useCurrentStage 훅으로 통합 |
| 4. 외부 딥링크 | ⚠️ 부분 | Booking.com, 에어비앤비, 스카이스캐너 기본 연결만 (파라미터 자동 채움 미완) |
| 5. PackingChecklist 세분화 | ❌ 미구현 | 현재 단일 preparation 카테고리 |
| 6. D-day 카운트다운 | ✅ 완료 | NudgeBar 내 dDayText |
| 7. phase 자동 전환 제안 | ❌ 미구현 | |
| 8. 일일 브리핑 | ❌ 미구현 | |

### 최근 개발 이력

- CanvasSearch ↔ ItineraryWidget 기능 통합 (중복 제거)
- ItineraryWidget에 드래그&드롭 재정렬 + 크로스-DAY 이동 추가
- 야간 비행 (다음날 도착) 처리 — FlightCard, ReturnFlightCard, TransitFlightCard
- 항공편 수정 시 InvalidDate 버그 수정 (AirLabs API 공백 구분자 대응)
- 항공편 수정 시 취소 버튼 추가 + 출발편만 개별 초기화 (clearDepartureFlight)

### 아키텍처 메모

- **상태관리**: Zustand 단일 스토어 (`journey.store.ts`) + localStorage persist
  - 상태 필드 14개, 액션 32개
  - 기본 예산 카테고리: 항공 ₩450K / 숙소 ₩320K / 식비 ₩200K / 기타 ₩130K
- **컴포넌트 구조**: `bento/` (위젯 13개) + `journey/` (여정 흐름 6개, 이 중 3개 미사용)
- **API**: `/api/flight` 라우트 — AviationStack → AirLabs → AeroDataBox 순차 폴백 + 15분 캐시
- **주의**: AirLabs API는 scheduledTime을 공백 구분자(`2025-07-15 14:30`)로 반환할 수 있음 → `split('T')` 대신 `slice(0,10)` / `slice(11,16)` 사용

---

## 기술 스택
- Next.js 14 (App Router) + React 18
- Zustand (상태관리) + localStorage 영속화
- Three.js / React Three Fiber (3D)
- Tailwind CSS (스타일링)
- 외부 API: AviationStack, AirLabs, AeroDataBox (항공편), OpenWeatherMap (날씨)
